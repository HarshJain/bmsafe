// Values of read ADC Voltage and associated Temperature (1°C/ 10)

// Le calcul de la température est le suivant:
//
// T = B / ln(R/A)
// où A = 0,0986 et B = 3435 et R est la résistance du thermistor
// 
// R = 3000 * V / (5-V)
// où V est la tension mesurée par l'ADC
//
// V = 5*ADC / 1024
// où ADC est la mesure de la tension sur 10 bits
//
// On précalcule les valeurs puisqu'on a pas de fonction pour calculer le logarithme

const int convertTempTable[361][2]
={{1011,-400},
{1011,-395},
{1011,-390},
{1010,-385},
{1010,-380},
{1009,-375},
{1009,-370},
{1008,-365},
{1008,-360},
{1007,-355},
{1007,-350},
{1006,-345},
{1006,-340},
{1005,-335},
{1005,-330},
{1004,-325},
{1004,-320},
{1003,-315},
{1003,-310},
{1002,-305},
{1001,-300},
{1001,-295},
{1000,-290},
{999,-285},
{999,-280},
{998,-275},
{997,-270},
{997,-265},
{996,-260},
{995,-255},
{994,-250},
{993,-245},
{993,-240},
{992,-235},
{991,-230},
{990,-225},
{989,-220},
{988,-215},
{987,-210},
{986,-205},
{985,-200},
{984,-195},
{983,-190},
{982,-185},
{981,-180},
{980,-175},
{979,-170},
{978,-165},
{977,-160},
{976,-155},
{975,-150},
{973,-145},
{972,-140},
{971,-135},
{970,-130},
{968,-125},
{967,-120},
{966,-115},
{964,-110},
{963,-105},
{961,-100},
{960,-95},
{958,-90},
{957,-85},
{955,-80},
{954,-75},
{952,-70},
{950,-65},
{949,-60},
{947,-55},
{945,-50},
{944,-45},
{942,-40},
{940,-35},
{938,-30},
{936,-25},
{935,-20},
{933,-15},
{931,-10},
{929,-5},
{927,0},
{925,5},
{923,10},
{921,15},
{918,20},
{916,25},
{914,30},
{912,35},
{910,40},
{907,45},
{905,50},
{903,55},
{900,60},
{898,65},
{895,70},
{893,75},
{890,80},
{888,85},
{885,90},
{883,95},
{880,100},
{877,105},
{875,110},
{872,115},
{869,120},
{866,125},
{864,130},
{861,135},
{858,140},
{855,145},
{852,150},
{849,155},
{846,160},
{843,165},
{840,170},
{837,175},
{834,180},
{831,185},
{827,190},
{824,195},
{821,200},
{818,205},
{814,210},
{811,215},
{808,220},
{804,225},
{801,230},
{798,235},
{794,240},
{791,245},
{787,250},
{784,255},
{780,260},
{777,265},
{773,270},
{769,275},
{766,280},
{762,285},
{758,290},
{755,295},
{751,300},
{747,305},
{743,310},
{740,315},
{736,320},
{732,325},
{728,330},
{724,335},
{720,340},
{716,345},
{713,350},
{709,355},
{705,360},
{701,365},
{697,370},
{693,375},
{689,380},
{685,385},
{681,390},
{677,395},
{673,400},
{669,405},
{665,410},
{660,415},
{656,420},
{652,425},
{648,430},
{644,435},
{640,440},
{636,445},
{632,450},
{628,455},
{624,460},
{619,465},
{615,470},
{611,475},
{607,480},
{603,485},
{599,490},
{595,495},
{591,500},
{587,505},
{582,510},
{578,515},
{574,520},
{570,525},
{566,530},
{562,535},
{558,540},
{554,545},
{550,550},
{546,555},
{542,560},
{538,565},
{534,570},
{530,575},
{526,580},
{522,585},
{518,590},
{514,595},
{510,600},
{506,605},
{502,610},
{498,615},
{494,620},
{490,625},
{486,630},
{482,635},
{478,640},
{474,645},
{471,650},
{467,655},
{463,660},
{459,665},
{455,670},
{452,675},
{448,680},
{444,685},
{441,690},
{437,695},
{433,700},
{430,705},
{426,710},
{422,715},
{419,720},
{415,725},
{412,730},
{408,735},
{405,740},
{401,745},
{398,750},
{394,755},
{391,760},
{387,765},
{384,770},
{381,775},
{377,780},
{374,785},
{371,790},
{367,795},
{364,800},
{361,805},
{358,810},
{355,815},
{351,820},
{348,825},
{345,830},
{342,835},
{339,840},
{336,845},
{333,850},
{330,855},
{327,860},
{324,865},
{321,870},
{318,875},
{315,880},
{312,885},
{310,890},
{307,895},
{304,900},
{301,905},
{298,910},
{296,915},
{293,920},
{290,925},
{288,930},
{285,935},
{282,940},
{280,945},
{277,950},
{275,955},
{272,960},
{270,965},
{267,970},
{265,975},
{262,980},
{260,985},
{257,990},
{255,995},
{253,1000},
{250,1005},
{248,1010},
{246,1015},
{243,1020},
{241,1025},
{239,1030},
{237,1035},
{234,1040},
{232,1045},
{230,1050},
{228,1055},
{226,1060},
{224,1065},
{222,1070},
{220,1075},
{218,1080},
{216,1085},
{214,1090},
{212,1095},
{210,1100},
{208,1105},
{206,1110},
{204,1115},
{202,1120},
{200,1125},
{198,1130},
{196,1135},
{195,1140},
{193,1145},
{191,1150},
{189,1155},
{187,1160},
{186,1165},
{184,1170},
{182,1175},
{181,1180},
{179,1185},
{177,1190},
{176,1195},
{174,1200},
{172,1205},
{171,1210},
{169,1215},
{168,1220},
{166,1225},
{165,1230},
{163,1235},
{162,1240},
{160,1245},
{159,1250},
{157,1255},
{156,1260},
{154,1265},
{153,1270},
{152,1275},
{150,1280},
{149,1285},
{148,1290},
{146,1295},
{145,1300},
{144,1305},
{142,1310},
{141,1315},
{140,1320},
{138,1325},
{137,1330},
{136,1335},
{135,1340},
{133,1345},
{132,1350},
{131,1355},
{130,1360},
{129,1365},
{128,1370},
{126,1375},
{125,1380},
{124,1385},
{123,1390},
{122,1395},
{121,1400}};


int convertTemp(int ADC_Volt)
{
   unsigned int i = 0;

    if (ADC_Volt < convertTempTable[360][0]) {
		return convertTempTable[360][1];
	} else {
		while (convertTempTable[i][0] > ADC_Volt)
			i++;
		
		if (convertTempTable[i][0] - ADC_Volt <= ADC_Volt - convertTempTable[i][0])  
			return convertTempTable[i][1];
		else
			return convertTempTable[i-1][1];
	}
}
	
	